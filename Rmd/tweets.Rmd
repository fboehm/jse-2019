---
title: "Tweets"
author: "Frederick J. Boehm"
date: "4/9/2020"
output: html_document
---


## Goals

1. Write a R script to query twitter streaming api to get 1 percent sample over 5'.
1. Demonstrate how to set up a crontab to execute script every 5'.
1. Verify that crontab approach works by running it on my computer for, say, 15'.
    1. Cautions about twitter databases: deletions and amendments to tweets
1. Examine structure of JSON obtained from api. 

## R code to query twitter streaming api

Install `rtweet` package from CRAN.

```{r, eval = FALSE}
install.packages("rtweet")
install.packages("lubridate")
```

## Parse json file

```{r}
library(magrittr)
source("recover_tweets.R")
```


```{r}
date <- c("2020-05-10", "2020-05-11", "2020-05-12", "2020-05-13", "2020-05-14")
tweet_json_file <- c("../data/2020-05-10 12:00:01-tweets.json",
  "../data/2020-05-11 12:00:01-tweets.json", 
  "../data/2020-05-12 12:00:02-tweets.json",
  "../data/2020-05-13 12:00:02-tweets.json", 
  "../data/2020-05-14 12:00:02-tweets.json")
out <- purrr::pmap_dfc(tibble::tibble(date, tweet_json_file),
                       .f = function(date, tweet_json_file){
                         knitr::knit_expand(text = readLines("tweets-one.Rmd"))
                       })
```

## May 10, 2020

`r knitr::knit(text = out[[1]])`

## May 11, 2020

`r knitr::knit(text = out[[2]])`



### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```
